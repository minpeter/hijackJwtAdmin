# 누출된 예비 패스워드 목록과 jwt 관리자 세션

## 시나리오

당신은 보안회사 dfcSec의 고용된 화이트해커이다.

의류 쇼핑몰 회사인 **MUSASIN**에서 보안관리자의 실수로 인터넷에 회사 시스템에서 이용되는 암호 리스트가 불특정 다수에게 유출되는 사건이 발생하였다.

유출 사실을 파악한 직후 보안관리자가 빠르게 파일을 삭제하긴하였지만 이로인해 발생할 수 있는 보안취약점을 파악하고 해결하기 위해 dfcSec에 모의해킹을 의뢰하였다.

시스템 전반에 거쳐 사용되는 암호리스트가 유출된만큼 빠른 변경이 필요하지만 어느 시스템에 암호를 변경해야될지 모르는 상황에서 가장 접근이 쉬운 MUSASIN 회사 홈페이지의 로그인 로직을 점검하기로 결정했다.

다음은 MUSASIN의 홈페이지 주소이다.

로그인 로직에 유출된 페스워드로 인해 발생할 수 있는 피해를 조사하며 관리자 계정에 존재하는 플래그를 찾아보자.

## 문제 구성

미리 유출됬다고 설명한 WORDLIST와 홈페이지 주소를 제공한다.

홈페이지의 백엔드는 CORS 설정을 전체 허용으로 두고 주소를 노출한다.

로그인로직은 JWT 인증 방식을 사용했으며 토큰 2번쨰 영역에 관리자인지 구분하는 필드가 존재한다.

미리 누출된 비밀번호 목록을 통해 Bruteforce를 이용해 서버에서 사용하는 시크릿을 알아낸 후 관리자라고 조작된 필드를 인코딩해 직접 백엔드 서버로 요청을 보낸다면 홈페이지에서 보이던 관리자만 접근할 수 있는 페이지에 접근할 수 있게된다.

관리자 페이지에는 토큰이 나와있으며 토큰을 입력하면 풀제가 풀이된다.