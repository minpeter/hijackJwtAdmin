# 문제 풀이

## 1. 문제 분석
미리 유출됬다고 설명한 WORDLIST와 인증서버의 주소, 인증서버 소스코드를 제공한다.

인증서버는 JWT 인증 방식을 사용했으며 토큰 2번쨰 영역에 관리자인지 구분하는 isAdmin 필드가 존재한다.  

우선 auth/signup 를 이용해 일반 유저 권한의 JWT 토큰을 발급 받는다.  

## 2. 토큰 디코딩

이를 decode 해보면 다음과 같은 구조를 가지고 있다.  

```json
{
  "exp": 1662507820,
  "isAdmin": false,
  "user id": 1
}
```

토큰 유효기간, ID, 관리자 여부 3가지로 이루어진 것을 알 수 있다.  

## 3. wordlist 무차별 대입으로 시크릿 탈취
이제 jwt-hack과 같은 툴이 이용해서 wordlist의 모든 단어로 방금 발급받은 JWT 토큰의 헤더와 페이로드를 해싱한다.  
그 후 토큰의 VERIFY SIGNATURE와 일치하는지 비교, 일치하다면 해당 단어가 서버에서 사용하는 시크릿인것으로 간주한다.  

## 4. JWT 토큰 위조
이제 서버 시크릿을 알기 때문에 토큰을 마음대로 조작할 수 있는데, 이 경우 관리자를 사칭하기 위해 isAdmin 필드를 수정한다.  

```json
{
  "exp": 2662507820,
  "isAdmin": true,
  "user id": 1
}
```

이제 위의 정보와 서버의 시크릿을 이용해 다시 인코딩하여 서버에 요청을 보내면 어드민이라고 인식한다.  

## 5. 플래그 획득

서버에 인덱스 페이지에서 알려주는 /admin/flag 로 요청을 보내면 플래그를 획득할 수 있다.  
